# Two key Network-Layer Functions

## Forwarding

## Routing

# Internet Protocol Suite
![[Pasted image 20240103102412.png]]

# Network Layer Service Models
![[Pasted image 20240103102624.png]]

## IP Service: Best-Effort is Enough
- No error detection or correction
	- Higher-level protocol can provide error checking
 - Successive packets may not follow the same path
	- Not a problem as long as packets reach the destination
- Packets can be delivered out-of-order
	- Receiver can put packets back in order (if necessary)
- Packets may be lost or arbitrarily delayed
	- Sender can send the packets again (if desired)
- No network congestion control (beyond “drop”)
	- Sender can slow down in response to loss or delay

# IP Packet Structure
![[2023.10.23#IPv4 packet structure]]

## TLL
![[Pasted image 20240103105428.png]]

*Time-to-live* field in the packet header to avoid forwarding loops that can cause packets to cycle forever:
- TTL field decremented by each routher on path
- Packet is discarded when TTL field reaches 0
- "time exceeded" message (ICMP) sent to source



https://traceroute-online.com

# IPv6 packet structure
![[Pasted image 20240103105537.png]]

# The Internet
The internet is an "inter-network", used to connect *networks*, not *hosts*.
![[Pasted image 20240103111843.png]]
**LAN** = **L**ocal **A**rea **N**etwork
**WAN** = **W**ide **A**rea **N**etwork

## Scalability challenge

If hosts had arbitrary addresses then every routed would need a lot of information to know how to direct packets towards every host.

![[Pasted image 20240103112317.png]]

**Forwarding table** (**forwarding information base**)
![[Pasted image 20240103112332.png]]
### Hierarchical Addressing
**IP Prefixes**

IP addresses can be divided into two:
- Network (left)
- Host (right)
![[Pasted image 20240103112159.png]]

## Subnets
![[Pasted image 20240103112511.png]]

## Classless Inter-Domain Routing (CIDR)
- IP prefix = IP address and subnet mask
- IP address = 
![[Pasted image 20240103112728.png]]
```zsh
ifconfig

	en1: flags=8863<UP,BROADCAST,…,MULTICAST> mtu 1500
	inet 192.168.1.1 netmask 0xffffff00 broadcast 192.168.1.255
	ether 21:23:0e:f3:51:3a
```

# Middleboxes
**Middleboxes** are intermediaries, interposed in-between the communicating hosts.

Examples are:
- Network address translators
- Firewalls
- Tunnel endpoints
- Traffic shapers
- Instrusion detection systems
- Transparent Web proxy caches
- Application accelerators

## NAT
![[Pasted image 20240103115632.png]]



![[Pasted image 20240103115718.png]]
# Exam question
- **Bring your own device**
	- All tools are allowed
	- Internet access, but ChatGPT / Google not allowed
- Wednesday, January 24th, time not determined yet

# Exercises
[KR] p. 327 
![[Pasted image 20240103133158.png]]
The figure is using the **TCP Reno** protocol.

- Identify the intervals of time when TCP slow start is operating.

	From 1-6 and 23-26 

- Identify the intervals of time when TCP congestion avoidance is operating.

	Congestion avoidance is operating from 6-16 and 17-22

- After the 16th transmission round, is segment loss detected by a triple duplicate ACK or by a timeout?

	Triple duplicate ACK, since the windows size is halved.

- After the 22nd transmission round, is segment loss detected by a triple duplicate ACK or by a timeout?

	Timeout

- What is the initial value of $\texttt{ssthresh}$ at the first transmission round?
	![[Pasted image 20240103135733.png]]
	32KB, since we switch from *slow start* to *congestion avoidance* when $\texttt{ssthresh=cwnd/2}$, which happens after round 32.


- What is the value of $\texttt{ssthresh}$ at the 22nd transmission round?
	
	15KB, since we switch from *congestion avoidance* to *slow start*, which happens when $\texttt{ssthresh=cwnd/2}$, which is 29 in this case.

- During what transmission round is the 70th segment sent?

	Each transmission round sends the amount of segments in the congestion window size.
	32 + 16 + 8 + 4 + 2 + 1 = 63
	So the 70th segment is sent after the 6th segment, during the 7th.

- Assuming a packet loss is detected after 26th round by the receipt of a triple duplicate ACK, what will be the values of the congestion window size and of $\texttt{ssthresh}$

	During the 26th round we are in a slow start.
	If we encounter a triple duplicate ACK we will go into Fast Recovery and $\texttt{ssthresh=cwnd/2}$ and $\texttt{cwnd=ssthresh+3*MSS}$. 

- Suppose TCP Tahoe is used (instead of TCP Reno) and assume that triple duplicate ACKs are received at the 10th round. What are the $\texttt{ssthresh}$ and the congestion window size at the 11th round?



- Again, suppose TCP Tahoe is used, and there is a timeout event at the 22nd round.

